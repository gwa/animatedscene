define(["Gwa.Event.Dispatcher"],function(a){return function(b,c){var d,e,f=!1,g=!1,h=b,i=0,j=Math.round(1e3/c),k=[],l={},m=new a;return l.on=function(a,b,c,d){return m.on(a,b,c,d)},l.off=function(a,b){m.off(a,b)},l.addObject=function(a){k.push(a)},l.render=function(){for(var a in k)k[a].calculateFrames(h);f=!0},l.gotoFrame=function(a){var b;a=Math.min(h,Math.max(0,a)),f||this.render(),this.stop();for(b in k)k[b].gotoFrame(a);this.dispatch("ENTER_FRAME",a)},l.play=function(){var a;f||this.render(),d=0,a=function(){for(var a in k)k[a].gotoFrame(i);i++,i>h&&(g?(i=0,this.dispatch("LOOP",d),d++):this.stop())},clearInterval(e),e=setInterval(a,j),this.dispatch("PLAY")},l.stop=function(){clearInterval(e),this.dispatch("STOP")},l.gotoAndPlay=function(a){a=Math.max(0,Math.min(a,h)),i=a,this.play()},l.doLoop=function(a){g=a===!0?!0:!1},l}});